---
- name: Create Sun-ui root directory
  file:
    path: /opt/icaro/sun-ui/
    state: directory
    recurse: yes

- name: Download Sun-ui package
  get_url:
    url: "{{ icaro.url }}/releases/download/{{ icaro.version }}/sun-ui.tar.gz"
    force: yes
    dest: /tmp/sun-ui.tar.gz

- name: Unpack Sun-ui package
  unarchive:
    src: /tmp/sun-ui.tar.gz
    dest: /opt/icaro/sun-ui/
    remote_src: yes

- name: Download Sun-ui assets
  unarchive:
    src: "{{ icaro.sun_ui.assets_url }}"
    dest: /opt/icaro/sun-ui/static/
    remote_src: yes
  when: icaro.sun_ui.assets_url is defined

- name: Set Sun-ui title
  lineinfile:
    path: /opt/icaro/sun-ui/static/config/config.js
    regexp: "^  APP_NAME: '<YOUR_APP_NAME>',"
    line: "  APP_NAME: '{{ icaro.sun_ui.title }}',"
  when: icaro.sun_ui.title is defined

- name: Remove temp files
  file:
    path:
      - /tmp/sun-ui.tar.gz
    state: absent
